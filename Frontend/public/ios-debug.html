<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>iOS Debug Test</title>
    <style>
        body { font-family: system-ui; padding: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .pass { background: #d4edda; }
        .fail { background: #f8d7da; }
    </style>
</head>
<body>
    <h1>iOS Compatibility Test</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        function addResult(test, passed, details = '') {
            const div = document.createElement('div');
            div.className = `test ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `<strong>${test}:</strong> ${passed ? 'PASS' : 'FAIL'} ${details}`;
            results.appendChild(div);
        }
        
        // Test 1: Optional chaining
        try {
            const obj = {};
            const test = obj?.test?.value;
            addResult('Optional chaining (?.)', true);
        } catch (e) {
            addResult('Optional chaining (?.)', false, e.message);
        }
        
        // Test 2: Nullish coalescing
        try {
            const test = null ?? 'default';
            addResult('Nullish coalescing (??)', true);
        } catch (e) {
            addResult('Nullish coalescing (??)', false, e.message);
        }
        
        // Test 3: Async/await
        try {
            (async () => {
                const test = await Promise.resolve('success');
                addResult('Async/await', true);
            })();
        } catch (e) {
            addResult('Async/await', false, e.message);
        }
        
        // Test 4: ES6 imports (simulated)
        try {
            const { test } = { test: 'value' };
            addResult('Destructuring', true);
        } catch (e) {
            addResult('Destructuring', false, e.message);
        }
        
        // Test 5: Arrow functions
        try {
            const test = () => 'success';
            addResult('Arrow functions', true);
        } catch (e) {
            addResult('Arrow functions', false, e.message);
        }
        
        // Test 6: Template literals
        try {
            const test = `template literal`;
            addResult('Template literals', true);
        } catch (e) {
            addResult('Template literals', false, e.message);
        }
        
        // Test 7: localStorage
        try {
            localStorage.setItem('test', 'value');
            localStorage.removeItem('test');
            addResult('localStorage', true);
        } catch (e) {
            addResult('localStorage', false, e.message);
        }
        
        // Device info
        const info = document.createElement('div');
        info.className = 'test';
        info.innerHTML = `
            <strong>Device Info:</strong><br>
            User Agent: ${navigator.userAgent}<br>
            Platform: ${navigator.platform}<br>
            Language: ${navigator.language}<br>
            Cookies Enabled: ${navigator.cookieEnabled}<br>
            Local Storage: ${typeof(Storage) !== "undefined"}<br>
            Screen: ${screen.width}x${screen.height}
        `;
        results.appendChild(info);
        
        // Global error handler
        window.addEventListener('error', (e) => {
            addResult('Global Error Caught', false, `${e.message} at ${e.filename}:${e.lineno}`);
        });
        
        window.addEventListener('unhandledrejection', (e) => {
            addResult('Unhandled Promise Rejection', false, e.reason);
        });
    </script>
</body>
</html>
